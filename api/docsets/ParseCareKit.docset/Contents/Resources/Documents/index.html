<!DOCTYPE html>
<html lang="en">
  <head>
    <title>ParseCareKit  Reference</title>
    <link rel="stylesheet" type="text/css" href="css/jazzy.css" />
    <link rel="stylesheet" type="text/css" href="css/highlight.css" />
    <meta charset="utf-8">
    <script src="js/jquery.min.js" defer></script>
    <script src="js/jazzy.js" defer></script>
    
    <script src="js/lunr.min.js" defer></script>
    <script src="js/typeahead.jquery.js" defer></script>
    <script src="js/jazzy.search.js" defer></script>
  </head>
  <body>


    <a title="ParseCareKit  Reference"></a>

    <header class="header">
      <p class="header-col header-col--primary">
        <a class="header-link" href="index.html">
          ParseCareKit 1.0 Docs
        </a>
         (92% documented)
      </p>
    
      <div class="header-col--secondary">
        <form role="search" action="search.json">
          <input type="text" placeholder="Search documentation" data-typeahead>
        </form>
      </div>
    
        <p class="header-col header-col--secondary">
          <a class="header-link" href="https://github.com/netreconlab/ParseCareKit">
            <img class="header-icon" src="img/gh.png" alt="GitHub"/>
            View on GitHub
          </a>
        </p>
    
        <p class="header-col header-col--secondary">
          <a class="header-link" href="dash-feed://https%3A%2F%2Fnetreconlab.github.io%2Fapi%2Fdocsets%2FParseCareKit.xml">
            <img class="header-icon" src="img/dash.png" alt="Dash"/>
            Install in Dash
          </a>
        </p>
    </header>

    <p class="breadcrumbs">
      <a class="breadcrumb" href="index.html">ParseCareKit Reference</a>
      <img class="carat" src="img/carat.png" alt=""/>
      ParseCareKit  Reference
    </p>

    <div class="content-wrapper">
      <nav class="navigation">
        <ul class="nav-groups">
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Classes.html">Classes</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/PCKUtility.html">PCKUtility</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/ParseRemote.html">ParseRemote</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Enums.html">Enumerations</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/CarePlanKey.html">CarePlanKey</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/ClockKey.html">ClockKey</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/ContactKey.html">ContactKey</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/ObjectableKey.html">ObjectableKey</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/OutcomeKey.html">OutcomeKey</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/PCKStoreClass.html">PCKStoreClass</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/ParseKey.html">ParseKey</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/PatientKey.html">PatientKey</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/TaskKey.html">TaskKey</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/VersionableKey.html">VersionableKey</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Extensions.html">Extensions</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/OCKCarePlan.html">OCKCarePlan</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/OCKContact.html">OCKContact</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/OCKHealthKitTask.html">OCKHealthKitTask</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/OCKOutcome.html">OCKOutcome</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/OCKPatient.html">OCKPatient</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/OCKTask.html">OCKTask</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Protocols.html">Protocols</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/PCKObjectable.html">PCKObjectable</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/PCKSynchronizable.html">PCKSynchronizable</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/PCKVersionable.html">PCKVersionable</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/ParseRemoteDelegate.html">ParseRemoteDelegate</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Structs.html">Structures</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/PCKCarePlan.html">PCKCarePlan</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/PCKContact.html">PCKContact</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/PCKHealthKitTask.html">PCKHealthKitTask</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/PCKOutcome.html">PCKOutcome</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/PCKPatient.html">PCKPatient</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/PCKTask.html">PCKTask</a>
              </li>
            </ul>
          </li>
        </ul>
      </nav>
      <article class="main-content">

        <section class="section">
          <div class="section-content top-matter">
            
            <h1 id='parsecarekit' class='heading'>ParseCareKit</h1>

<p><a href="https://swiftpackageindex.com/netreconlab/ParseCareKit"><img src="https://img.shields.io/endpoint?url=https%3A%2F%2Fswiftpackageindex.com%2Fapi%2Fpackages%2Fnetreconlab%2FParseCareKit%2Fbadge%3Ftype%3Dswift-versions" alt=""></a>
<a href="https://swiftpackageindex.com/netreconlab/ParseCareKit"><img src="https://img.shields.io/endpoint?url=https%3A%2F%2Fswiftpackageindex.com%2Fapi%2Fpackages%2Fnetreconlab%2FParseCareKit%2Fbadge%3Ftype%3Dplatforms" alt=""></a>
<img src="https://img.shields.io/badge/xcode-13.2%2B-blue.svg" alt="Xcode 13.2+">
<a href="https://github.com/netreconlab/ParseCareKit/actions?query=workflow%3Aci"><img src="https://github.com/netreconlab/ParseCareKit/workflows/ci/badge.svg?branch=main" alt="CI Status"></a>
<a href="https://github.com/netreconlab/ParseCareKit/actions?query=workflow%3Arelease"><img src="https://github.com/netreconlab/ParseCareKit/workflows/release/badge.svg" alt="Release Status"></a>
<a href="https://github.com/netreconlab/ParseCareKit/actions?query=workflow%3Aslider"><img src="https://github.com/netreconlab/ParseCareKit/workflows/slider/badge.svg" alt="Slider Status"></a>
<img src="https://codecov.io/gh/netreconlab/ParseCareKit/branches/main/graph/badge.svg" alt="Codecov">
<a href="https://github.com/netreconlab/ParseCareKit/#license"><img src="https://img.shields.io/badge/license-MIT-green.svg?style=flat" alt="License"></a></p>

<p><strong>Use at your own risk. There is no promise that this is HIPAA compliant and we are not responsible for any mishandling of your data</strong></p>

<p>This framework is an API to synchronize <a href="https://github.com/carekit-apple/CareKit">CareKit</a> 2.1+ data with <a href="https://github.com/parse-community/parse-server">parse-server</a> using <a href="https://github.com/parse-community/Parse-Swift">Parse-Swift</a>. The learn more about how to use ParseCareKit check out the <a href="https://netreconlab.github.io/ParseCareKit/api/">API documentation</a> along with the rest of the README.</p>

<p>For the backend, it is suggested to use <a href="https://github.com/netreconlab/parse-hipaa">parse-hipaa</a> which is an out-of-the-box HIPAA compliant Parse/<a href="https://www.postgresql.org">Postgres</a> or Parse/<a href="https://www.mongodb.com">Mongo</a> server that comes with <a href="https://github.com/parse-community/parse-dashboard">Parse Dashboard</a>. Since <a href="https://github.com/netreconlab/parse-hipaa">parse-hipaa</a> is a pare-server, it can be used for <a href="https://docs.parseplatform.org/ios/guide/">iOS</a>, <a href="https://docs.parseplatform.org/android/guide/">Android</a>, and web based apps. API&rsquo;s such as <a href="https://docs.parseplatform.org/graphql/guide/">GraphQL</a>, <a href="https://docs.parseplatform.org/rest/guide/">REST</a>, and <a href="https://docs.parseplatform.org/js/guide/">JS</a> are also enabled in parse-hipaa and can be accessed directly or tested via the &ldquo;API Console&rdquo; in parse-dashboard. See the <a href="https://parseplatform.org/#sdks">Parse SDK documentation</a> for details. These docker images include the necessary database auditing and logging for HIPAA compliance.</p>

<p>You can also use ParseCareKit with any parse-server setup. If you devide to use your own parse-server, it&rsquo;s strongly recommended to add the following <a href="https://github.com/netreconlab/parse-hipaa/tree/main/parse/cloud">CloudCode</a> to your server&rsquo;s &ldquo;cloud&rdquo; folder to ensure the necessary classes and fields are created as well as ensuring uniqueness of pushed entities. In addition, you should follow the <a href="https://github.com/netreconlab/parse-hipaa#running-in-production-for-parsecarekit">directions</a> to setup additional indexes for optimized queries. <strong><em>Note that CareKit data is extremely sensitive and you are responsible for ensuring your parse-server meets HIPAA compliance.</em></strong></p>

<p>The following CareKit Entities are synchronized with Parse tables/classes:</p>

<ul>
<li>[x] OCKPatient &lt;-&gt; Patient</li>
<li>[x] OCKCarePlan &lt;-&gt; CarePlan</li>
<li>[x] OCKTask &lt;-&gt; Task</li>
<li>[x] OCKHealthKitTask &lt;-&gt; HealthKitTask</li>
<li>[x] OCKContact &lt;-&gt; Contact</li>
<li>[x] OCKOutcome &lt;-&gt; Outcome</li>
<li>[x] OCKRevisionRecord.Clock &lt;-&gt; Clock</li>
</ul>

<p>ParseCareKit enables iOS and watchOS devices belonging to the same user to be reactively sychronized using <a href="https://docs.parseplatform.org/parse-server/guide/#live-queries">ParseLiveQuery</a> without the need of push notifications assuming the <a href="https://docs.parseplatform.org/parse-server/guide/#livequery-server">LiveQuery server has been configured</a>. </p>
<h2 id='carekit-sample-app-with-parsecarekit' class='heading'>CareKit Sample App with ParseCareKit</h2>

<p>A sample app, <a href="https://github.com/netreconlab/CareKitSample-ParseCareKit">CareKitSample-ParseCareKit</a>, connects to the aforementioned <a href="https://github.com/netreconlab/parse-hipaa">parse-hipaa</a> and demonstrates how CareKit data can be easily synched to the Cloud using ParseCareKit.</p>

<p><img src="https://user-images.githubusercontent.com/8621344/99022137-1ec7ca80-2530-11eb-897c-ace7c70536f2.png" width="300"> <img src="https://user-images.githubusercontent.com/8621344/99022190-3bfc9900-2530-11eb-8ad1-c1e8ba2e7f55.png" width="300"></p>
<h3 id='parsecarekit-plist-with-server-connection-information' class='heading'>ParseCareKit.plist with server connection information</h3>

<p>ParseCareKit comes with a helper method, <a href="https://github.com/netreconlab/ParseCareKit/blob/4912bf7677511d148b52d03146c31cc428a83454/ParseCareKit/PCKUtility.swift#L14">PCKUtility.setupServer()</a> that easily helps apps connect to your parse-server. To leverage the helper method, copy the <a href="https://github.com/netreconlab/CareKitSample-ParseCareKit/blob/main/OCKSample/Supporting%20Files/ParseCareKit.plist">ParseCareKit.plist</a> file your &ldquo;Supporting Files&rdquo; folder in your Xcode project. Be sure to change <code>ApplicationID</code> and <code>Server</code> to the correct values for your server. Simply add the following inside <code>didFinishLaunchingWithOptions</code> in <code>AppDelegate.swift</code>:</p>
<pre class="highlight swift"><code><span class="kd">func</span> <span class="nf">application</span><span class="p">(</span><span class="n">_</span> <span class="nv">application</span><span class="p">:</span> <span class="kt">UIApplication</span><span class="p">,</span> <span class="n">didFinishLaunchingWithOptions</span> <span class="nv">launchOptions</span><span class="p">:</span> <span class="p">[</span><span class="kt">UIApplication</span><span class="o">.</span><span class="kt">LaunchOptionsKey</span><span class="p">:</span> <span class="kt">Any</span><span class="p">]?)</span> <span class="o">-&gt;</span> <span class="kt">Bool</span> <span class="p">{</span>

<span class="c1">//Pulls from ParseCareKit.plist to connect to server</span>
<span class="kt">PCKUtility</span><span class="o">.</span><span class="nf">setupServer</span><span class="p">()</span> 

<span class="c1">//If you need certificate pinning:</span>
<span class="kt">PCKUtility</span><span class="o">.</span><span class="n">setupServer</span> <span class="p">{</span> <span class="p">(</span><span class="n">challenge</span><span class="p">,</span> <span class="n">completionHandler</span><span class="p">)</span> <span class="k">in</span>
    <span class="c1">//Return how you want to handle the challenge. See docs for more information.</span>
    <span class="nf">completionHandler</span><span class="p">(</span><span class="o">.</span><span class="n">performDefaultHandling</span><span class="p">,</span> <span class="kc">nil</span><span class="p">)</span>
<span class="p">}</span>
</code></pre>
<h2 id='what-version-of-parsecarekit-suits-your-needs' class='heading'>What version of ParseCareKit Suits Your Needs?</h2>

<ul>
<li>(Most cases) Need to use ParseCareKit for iOS13+ and/or watchOS7 and will be using the latest (the minimal required commit is from <a href="https://github.com/carekit-apple/CareKit/commit/248c42c4e4ea97ff5fe349361fa6e0a849eab204">PR #508</a>) <a href="https://github.com/carekit-apple/CareKit#carekit-">CareKit 2.1</a>, <a href="https://github.com/carekit-apple/CareKit#carekitui-">CareKitUI</a>, and <a href="https://github.com/carekit-apple/CareKit#carekitstore-">CareKitStore</a> (using <code>OCKStore</code>) within your app? You should use the <a href="https://github.com/netreconlab/ParseCareKit">main</a> branch. You can take advantage of all of the capabilities of ParseCareKit. You should use <code>ParseRemote()</code> see <a href="#synchronizing-your-data">below</a> more details. This branch uses the <a href="https://github.com/parse-community/Parse-Swift">Parse-Swift SDK</a> instead of the <a href="https://github.com/parse-community/Parse-SDK-iOS-OSX">Parse-Objc SDK</a>.</li>
<li>Need to use ParseCareKit for iOS13+ and/or watchOS7 and will be using the latest <a href="https://github.com/carekit-apple/CareKit#carekit-">CareKit</a>, <a href="https://github.com/carekit-apple/CareKit#carekitui-">CareKitUI</a>, and <a href="https://github.com/carekit-apple/CareKit#carekitstore-">CareKitStore</a> (but you would like to use the <a href="https://github.com/parse-community/Parse-SDK-iOS-OSX">Parse Objc SDK</a>) within your app? You will need to use Cocoapods and the <a href="https://github.com/netreconlab/ParseCareKit/tree/parse-objc">Parse-Objc SDK</a> branch. You can still use all of the capabilities of ParseCareKit. You should use <code>ParseSynchronizedStoreManager()</code> see <a href="https://github.com/netreconlab/ParseCareKit/tree/parse-objc#synchronizing-your-data">here</a> for more details.</li>
<li>Need to use ParseCareKit for iOS13+ and will be using <a href="https://github.com/carekit-apple/CareKit#carekit-">CareKit &lt;= 2.0.1</a>, <a href="https://github.com/carekit-apple/CareKit#carekitui-">CareKitUI &lt;= 2.0.1</a>, and <a href="https://github.com/carekit-apple/CareKit#carekitstore-">CareKitStore &lt;= 2.0.1</a> (using <code>OCKStore</code> or conforming to <code>OCKAnyStoreProtocol</code>) within your app? You should use the <a href="https://github.com/netreconlab/ParseCareKit/tree/carekit_2.0.1">carekit_2.0.1</a> branch. You can still use most of the capabilities of ParseCareKit, but you will be limited to syncing via a &ldquo;wall clock&rdquo; instead of &ldquo;knowledge vectors&rdquo;. You will also have to use the <a href="https://github.com/parse-community/Parse-SDK-iOS-OSX">Parse Objc SDK</a>) and Cocoapods. You should use <code>ParseSynchronizedStoreManager()</code> see <a href="https://github.com/netreconlab/ParseCareKit/tree/carekit_2.0.1#synchronizing-your-data">here</a> for more details.</li>
</ul>

<p><strong>Note that it is recommended to use Vectors Clocks (<code><a href="Classes/ParseRemote.html">ParseRemote</a></code>) over Wall Clocks (<code>ParseSynchronizedStoreManager</code>) as the latter can run into more synching issues. If you choose to go the wall clock route, I recommend having your application suited for 1 device per user to reduce potential synching issues. You can learn more about how vector clocks work by looking at <a href="https://en.wikipedia.org/wiki/Vector_clock">vector clocks</a>.</strong></p>
<h2 id='install-parsecarekit' class='heading'>Install ParseCareKit</h2>
<h3 id='swift-package-manager-spm' class='heading'>Swift Package Manager (SPM)</h3>

<p>ParseCareKit can be installed via SPM. Open an existing project or create a new Xcode project and navigate to <code>File &gt; Swift Packages &gt; Add Package Dependency</code>. Enter the url <code>https://github.com/netreconlab/ParseCareKit</code> and tap <code>Next</code>. Choose the main branch, and on the next screen, check off the package.</p>

<p>Note: ParseCareKit includes <a href="https://github.com/carekit-apple/CareKit#carekitstore-">CareKitStore</a> (it&rsquo;s a dependency) from CareKit&rsquo;s main branch, so there&rsquo;s no need to add CareKitStore to your app. If you want the rest of CareKit, you only need to add <a href="https://github.com/carekit-apple/CareKit#carekit-">CareKit</a> and <a href="https://github.com/carekit-apple/CareKit#carekitui-">CareKitUI</a> via SPM. Anytime you need ParseCareKit, simply add <code>import ParseCareKit</code> at the top of the file.</p>
<h3 id='installing-via-cocoapods' class='heading'>Installing via cocoapods</h3>

<p>To install via cocoapods, go to the <a href="https://github.com/netreconlab/ParseCareKit/tree/parse-objc#installing-via-cocoapods">Parse-Objc SDK</a> branch for the readme. The main branch isn&rsquo;t compatable with cocoapods as the CareKit framework isn&rsquo;t compatible with Cocoapods.</p>
<h3 id='installing-as-a-framework' class='heading'>Installing as a framework</h3>

<ul>
<li>Fork the project</li>
<li>Build the project</li>
<li>In your project Targets, click your corresponding target and then click the <code>General</code> heading to the right</li>
<li>Place <code>ParseCareKit.framework</code> in <code>Frameworks, Libraries, and Embedded Content</code> and it should automatically appear in <code>Linked Binary with Libraries</code> under the <code>Build Phases</code> section</li>
<li>Then, simply place <code>import ParseCareKit</code> at the top of any file that needs the framework.</li>
</ul>

<p><strong>If you have CareKit already in your project via SPM or copied, you will need to remove it as ParseCareKit comes with the a compatibile version of CareKit and a conflict of CareKit appearing twice will cause your app to crash</strong></p>
<h2 id='setup-parse-server' class='heading'>Setup Parse Server</h2>

<p>For details on how to setup parse-server, follow the directions <a href="https://github.com/parse-community/parse-server#getting-started">here</a> or look at their detailed <a href="https://docs.parseplatform.org/parse-server/guide/">guide</a>. Note that standard deployment locally on compouter, docker, AWS, Google Cloud, isn&rsquo;t HIPAA complaint by default. </p>
<h3 id='protecting-patients-data-in-the-cloud-using-acl-39-s' class='heading'>Protecting Patients data in the Cloud using ACL&rsquo;s</h3>

<p><code>ParseCareKit</code> will set a default ACL on every object saved to your Parse Server with read/write access only for the user who created the data. If you want different level of access by default, you should pass the default ACL you prefer while initializing <code>ParseCareKit</code>. For example, to make all data created to only be read and written by the user who created it, do the following:</p>
<pre class="highlight swift"><code><span class="c1">//Set default ACL for all Parse Classes</span>
<span class="k">var</span> <span class="nv">newACL</span> <span class="o">=</span> <span class="kt">ParseACL</span><span class="p">()</span>
<span class="n">newACL</span><span class="o">.</span><span class="n">publicRead</span> <span class="o">=</span> <span class="kc">false</span>
<span class="n">newACL</span><span class="o">.</span><span class="n">publicWrite</span> <span class="o">=</span> <span class="kc">false</span>        
<span class="n">newACL</span><span class="o">.</span><span class="nf">setReadAccess</span><span class="p">(</span><span class="nv">user</span><span class="p">:</span> <span class="n">user</span><span class="p">,</span> <span class="nv">value</span><span class="p">:</span> <span class="kc">true</span><span class="p">)</span>
<span class="n">newACL</span><span class="o">.</span><span class="nf">setWriteAccess</span><span class="p">(</span><span class="nv">user</span><span class="p">:</span> <span class="n">user</span><span class="p">,</span> <span class="nv">value</span><span class="p">:</span> <span class="kc">true</span><span class="p">)</span>
<span class="k">do</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">parse</span> <span class="o">=</span> <span class="k">try</span> <span class="kt">ParseRemote</span><span class="p">(</span><span class="nv">uuid</span><span class="p">:</span> <span class="kt">UUID</span><span class="p">(</span><span class="nv">uuidString</span><span class="p">:</span> <span class="s">"3B5FD9DA-C278-4582-90DC-101C08E7FC98"</span><span class="p">)</span><span class="o">!</span><span class="p">,</span>
                                <span class="nv">auto</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
                                <span class="nv">subscribeToServerUpdates</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
                                <span class="n">defaultACL</span><span class="p">:</span> <span class="n">newACL</span><span class="p">)</span>
<span class="p">}</span> <span class="k">catch</span> <span class="p">{</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">error</span><span class="o">.</span><span class="n">localizedDescription</span><span class="p">)</span>
<span class="p">}</span>
</code></pre>

<p>When giving access to a CareTeam or other entities, special care should be taken when deciding the propper ACL or Role. Feel free to read more about <a href="https://docs.parseplatform.org/ios/guide/#security-for-user-objects">ACLs</a> and <a href="https://docs.parseplatform.org/ios/guide/#roles">Role</a> access in Parse. For details, your setup should look similar to the code <a href="https://github.com/netreconlab/CareKitSample-ParseCareKit/blob/a4b1106816f37d227ad9a6ea3e84e02556ccbbc8/OCKSample/AppDelegate.swift#L53">here</a>.</p>
<h2 id='synchronizing-your-data' class='heading'>Synchronizing Your Data</h2>

<p>Assuming you are already familiar with <a href="https://github.com/carekit-apple/CareKit">CareKit</a> (look at their documentation for details). Using ParseCareKit is simple, especially if you are using <code>OCKStore</code> out-of-the-box. If you are using a custom <code>OCKStore</code> you will need to subclass and write some additional code to synchronize your care-store with parse-server.</p>
<h3 id='using-vector-clocks-aka-carekit-39-s-knowledgevector-code-parseremote-code' class='heading'>Using vector clocks aka CareKit&rsquo;s KnowledgeVector (<code><a href="Classes/ParseRemote.html">ParseRemote</a></code>)</h3>

<p>ParseCareKit stays synchronized with the <code>OCKStore</code> by leveraging <code>OCKRemoteSynchronizable</code>.  I recommend having this as a singleton, as it can handle all syncs from the carestore. An example is below:</p>
<pre class="highlight swift"><code><span class="cm">/*Use Clock and OCKRemoteSynchronizable to keep data synced. 
This works with 1 or many devices per patient.*/</span>
<span class="k">let</span> <span class="nv">uuid</span> <span class="o">=</span> <span class="kt">UUID</span><span class="p">(</span><span class="nv">uuidString</span><span class="p">:</span> <span class="s">"3B5FD9DA-C278-4582-90DC-101C08E7FC98"</span><span class="p">)</span><span class="o">!</span>
<span class="k">let</span> <span class="nv">remoteStoreManager</span> <span class="o">=</span> <span class="kt">ParseRemote</span><span class="p">(</span><span class="nv">uuid</span><span class="p">:</span> <span class="n">uuid</span><span class="p">,</span> <span class="nv">auto</span><span class="p">:</span> <span class="kc">true</span><span class="p">)</span>
<span class="k">let</span> <span class="nv">dataStore</span> <span class="o">=</span> <span class="kt">OCKStore</span><span class="p">(</span><span class="nv">name</span><span class="p">:</span> <span class="s">"myDataStore"</span><span class="p">,</span> <span class="nv">type</span><span class="p">:</span> <span class="o">.</span><span class="n">onDisk</span><span class="p">,</span> <span class="nv">remote</span><span class="p">:</span> <span class="n">remoteStoreManager</span><span class="p">)</span>
<span class="n">remoteStoreManager</span><span class="o">.</span><span class="n">delegate</span> <span class="o">=</span> <span class="k">self</span> <span class="c1">//Conform to this protocol if you are writing custom CloudCode in Parse and want to push syncs</span>
<span class="n">remoteStoreManager</span><span class="o">.</span><span class="n">parseRemoteDelegate</span> <span class="o">=</span> <span class="k">self</span> <span class="c1">//Conform to this protocol to resolve conflicts</span>
</code></pre>

<p>The <code>uuid</code> being passed to <code><a href="Classes/ParseRemote.html">ParseRemote</a></code> is used for the Clock. A possibile solution that allows for high flexibity is to have 1 of these per user-type per user. This allows you to have have one <code>ParseUser</code> that can be a &ldquo;Doctor&rdquo; and a &ldquo;Patient&rdquo;. You should generate a different uuid for this particular ParseUser&rsquo;s <code>Doctor</code> and <code><a href="Structs/PCKPatient.html">PCKPatient</a></code> type. You can save all types to ParseUser:</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">userTypeUUIDDictionary</span> <span class="o">=</span> <span class="p">[</span>
<span class="s">"doctor"</span><span class="p">:</span> <span class="kt">UUID</span><span class="p">()</span><span class="o">.</span><span class="n">uuidString</span><span class="p">,</span>
<span class="s">"patient"</span><span class="p">:</span> <span class="kt">UUID</span><span class="p">()</span><span class="o">.</span><span class="n">uuidString</span>
<span class="p">]</span>

<span class="c1">//Store the possible uuids for each type</span>
<span class="k">guard</span> <span class="k">var</span> <span class="nv">user</span> <span class="o">=</span> <span class="kt">User</span><span class="o">.</span><span class="n">current</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">return</span>
<span class="p">}</span>
<span class="n">user</span><span class="o">.</span><span class="n">userTypes</span> <span class="o">=</span> <span class="n">userTypeUUIDDictionary</span> <span class="c1">//Note that you need to save the UUID in string form to Parse</span>
<span class="n">user</span><span class="o">.</span><span class="n">loggedInType</span> <span class="o">=</span> <span class="s">"doctor"</span> 
<span class="n">user</span><span class="o">.</span><span class="nf">save</span><span class="p">()</span>

<span class="c1">//Start synch with the correct knowlege vector for the particular type of user</span>
<span class="k">let</span> <span class="nv">lastLoggedInType</span> <span class="o">=</span> <span class="kt">User</span><span class="o">.</span><span class="n">current</span><span class="p">?</span><span class="o">.</span><span class="n">loggedInType</span>
<span class="k">let</span> <span class="nv">userTypeUUIDString</span> <span class="o">=</span> <span class="kt">User</span><span class="o">.</span><span class="n">current</span><span class="p">?</span><span class="o">.</span><span class="n">userTypes</span><span class="p">[</span><span class="n">lastLoggedInType</span><span class="p">]</span> <span class="k">as!</span> <span class="kt">String</span>
<span class="k">let</span> <span class="nv">userTypeUUID</span> <span class="o">=</span> <span class="kt">UUID</span><span class="p">(</span><span class="nv">uuidString</span><span class="p">:</span> <span class="n">userTypeUUID</span><span class="p">)</span><span class="o">!</span>

<span class="c1">//Start synching </span>
<span class="k">let</span> <span class="nv">remoteStoreManager</span> <span class="o">=</span> <span class="kt">ParseRemote</span><span class="p">(</span><span class="nv">uuid</span><span class="p">:</span> <span class="n">userTypeUUID</span><span class="p">,</span> <span class="nv">auto</span><span class="p">:</span> <span class="kc">true</span><span class="p">)</span>
<span class="k">let</span> <span class="nv">dataStore</span> <span class="o">=</span> <span class="kt">OCKStore</span><span class="p">(</span><span class="nv">name</span><span class="p">:</span> <span class="s">"myDataStore"</span><span class="p">,</span> <span class="nv">type</span><span class="p">:</span> <span class="o">.</span><span class="n">onDisk</span><span class="p">,</span> <span class="nv">remote</span><span class="p">:</span> <span class="n">remoteStoreManager</span><span class="p">)</span>
<span class="n">remoteStoreManager</span><span class="o">.</span><span class="n">delegate</span> <span class="o">=</span> <span class="k">self</span> <span class="c1">//Conform to this protocol if you are writing custom CloudCode in Parse and want to push syncs</span>
<span class="n">remoteStoreManager</span><span class="o">.</span><span class="n">parseRemoteDelegate</span> <span class="o">=</span> <span class="k">self</span> <span class="c1">//Conform to this protocol to resolve conflicts</span>
</code></pre>

<p>Register as a delegate just in case ParseCareKit needs your application to update a CareKit entity. ParseCareKit doesn&rsquo;t have access to your CareKitStor, so your app will have to make the necessary update if ParseCareKit detects a problem and needs to make an update locally. Registering for the delegates also allows you to handle synching conflicts. An example is below:</p>
<pre class="highlight swift"><code><span class="kd">extension</span> <span class="kt">AppDelegate</span><span class="p">:</span> <span class="kt">OCKRemoteSynchronizationDelegate</span><span class="p">,</span> <span class="kt">ParseRemoteDelegate</span><span class="p">{</span>
    <span class="kd">func</span> <span class="nf">didRequestSynchronization</span><span class="p">(</span><span class="n">_</span> <span class="nv">remote</span><span class="p">:</span> <span class="kt">OCKRemoteSynchronizable</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"Implement so ParseCareKit can tell your OCKStore to sync to the cloud"</span><span class="p">)</span>
        <span class="c1">//example</span>
        <span class="n">store</span><span class="o">.</span><span class="n">synchronize</span> <span class="p">{</span> <span class="n">error</span> <span class="k">in</span>
            <span class="nf">print</span><span class="p">(</span><span class="n">error</span><span class="p">?</span><span class="o">.</span><span class="n">localizedDescription</span> <span class="p">??</span> <span class="s">"Successful sync with remote!"</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="kd">func</span> <span class="nf">remote</span><span class="p">(</span><span class="n">_</span> <span class="nv">remote</span><span class="p">:</span> <span class="kt">OCKRemoteSynchronizable</span><span class="p">,</span> <span class="n">didUpdateProgress</span> <span class="nv">progress</span><span class="p">:</span> <span class="kt">Double</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"Completed: </span><span class="se">\(</span><span class="n">progress</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="kd">func</span> <span class="nf">chooseConflictResolutionPolicy</span><span class="p">(</span><span class="n">_</span> <span class="nv">conflict</span><span class="p">:</span> <span class="kt">OCKMergeConflictDescription</span><span class="p">,</span> <span class="nv">completion</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="p">(</span><span class="kt">OCKMergeConflictResolutionPolicy</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">conflictPolicy</span> <span class="o">=</span> <span class="kt">OCKMergeConflictResolutionPolicy</span><span class="o">.</span><span class="n">keepDevice</span>
        <span class="nf">completion</span><span class="p">(</span><span class="n">conflictPolicy</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="kd">func</span> <span class="nf">successfullyPushedDataToCloud</span><span class="p">(){</span>        
             <span class="nf">print</span><span class="p">(</span><span class="s">"Notified when data is succefully pushed to the cloud"</span><span class="p">)</span>        
         <span class="p">}</span>
    <span class="p">}</span>

</code></pre>
<h2 id='customizing-parse-entities-to-sync-with-carekit' class='heading'>Customizing Parse Entities to Sync with CareKit</h2>

<p>There will be times you need to customize entities by adding fields that are different from the standard CareKit entity fields. If the fields you want to add can be converted to strings, it is recommended to take advantage of the <code>userInfo: [String:String]</code> field of a CareKit entity. To do this, you simply extend the entity you want customize using <code>extension</code>. For example, below shows how to add fields to OCKPatient&lt;-&gt;Patient:</p>
<pre class="highlight swift"><code><span class="kd">extension</span> <span class="kt">Patient</span><span class="p">:</span> <span class="kt">Person</span> <span class="p">{</span>
    <span class="k">var</span> <span class="nv">primaryCondition</span> <span class="kt">String</span><span class="p">?</span> <span class="p">{</span>
        <span class="k">guard</span> <span class="k">let</span> <span class="nv">userInfo</span> <span class="o">=</span> <span class="n">userInfo</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">return</span> <span class="kc">nil</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">userInfo</span><span class="p">[</span><span class="s">"CustomPatientUserInfoPrimaryConditionKey"</span><span class="p">]</span>
    <span class="p">}</span>

    <span class="k">mutating</span> <span class="kd">func</span> <span class="nf">setPrimaryCondition</span><span class="p">(</span><span class="n">_</span> <span class="nv">primaryCondition</span><span class="p">:</span> <span class="kt">String</span><span class="p">?)</span> <span class="p">{</span>
        <span class="k">var</span> <span class="nv">mutableUserInfo</span> <span class="o">=</span> <span class="nf">currentUserInfo</span><span class="p">()</span>

        <span class="k">if</span> <span class="k">let</span> <span class="nv">primaryCondition</span> <span class="o">=</span> <span class="n">primaryCondition</span> <span class="p">{</span>
            <span class="n">mutableUserInfo</span><span class="p">[</span><span class="kt">PatientUserInfoKey</span><span class="o">.</span><span class="n">primaryCondition</span><span class="o">.</span><span class="n">rawValue</span><span class="p">]</span> <span class="o">=</span> <span class="n">primaryCondition</span>
        <span class="p">}</span><span class="k">else</span><span class="p">{</span>
            <span class="n">mutableUserInfo</span><span class="o">.</span><span class="nf">removeValue</span><span class="p">(</span><span class="nv">forKey</span><span class="p">:</span> <span class="kt">PatientUserInfoKey</span><span class="o">.</span><span class="n">primaryCondition</span><span class="o">.</span><span class="n">rawValue</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="n">userInfo</span> <span class="o">=</span> <span class="n">mutableUserInfo</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<p>If you want to make you own types and use them to replace the concrete CareKit ones. You should copy/paste the respective code from ParseCareKit, e.g. <code><a href="Structs/PCKPatient.html">PCKPatient</a></code>, <code><a href="Structs/PCKContact.html">PCKContact</a></code>, <code><a href="Structs/PCKTask.html">PCKTask</a></code>, etc. Then you need to pass your custom struct when initializing <code>ParseRemoteSynchronizingManager</code>. The way to do this is below:</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">updatedConcreteClasses</span><span class="p">:</span> <span class="p">[</span><span class="kt">PCKStoreClass</span><span class="p">:</span> <span class="kt">PCKSynchronizable</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
    <span class="o">.</span><span class="nv">patient</span><span class="p">:</span> <span class="kt">CancerPatient</span><span class="p">()</span>
<span class="p">]</span>

<span class="n">remoteStoreManager</span> <span class="o">=</span> <span class="kt">ParseRemote</span><span class="p">(</span><span class="nv">uuid</span><span class="p">:</span> <span class="n">uuid</span><span class="p">,</span> <span class="nv">auto</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span> <span class="nv">replacePCKStoreClasses</span><span class="p">:</span> <span class="n">updatedConcreteClasses</span><span class="p">)</span>
<span class="n">dataStore</span> <span class="o">=</span> <span class="kt">OCKStore</span><span class="p">(</span><span class="nv">name</span><span class="p">:</span> <span class="n">storeName</span><span class="p">,</span> <span class="nv">type</span><span class="p">:</span> <span class="o">.</span><span class="nf">onDisk</span><span class="p">(),</span> <span class="nv">remote</span><span class="p">:</span> <span class="n">remoteStoreManager</span><span class="p">)</span>
<span class="n">remoteStoreManager</span><span class="o">.</span><span class="n">delegate</span> <span class="o">=</span> <span class="k">self</span>
<span class="n">remoteStoreManager</span><span class="o">.</span><span class="n">parseRemoteDelegate</span> <span class="o">=</span> <span class="k">self</span>
</code></pre>

<p>Of course, you can customize further by implementing your copyCareKit and converToCareKit methods and not call the super methods.</p>

<p>You can also map &ldquo;custom&rdquo; <code>Parse</code> classes to concrete <code>OCKStore</code> classes. This is useful when you want to have <code>Doctor</code>&lsquo;s and <code><a href="Structs/PCKPatient.html">PCKPatient</a></code>&rsquo;s in the same app, but would like to map them both locally to the <code>OCKPatient</code> table on iOS devices.  ParseCareKit makes this simple. Follow the same process as creating <code>CancerPatient</code> above, but add the <code>kPCKCustomClassKey</code> key to <code>userInfo</code> with <code>Doctor.className()</code> as the value. See below:</p>
<pre class="highlight swift"><code><span class="kd">struct</span> <span class="kt">Doctor</span><span class="p">:</span> <span class="kt">Patient</span> <span class="p">{</span>
    <span class="kd">public</span> <span class="k">var</span> <span class="nv">type</span><span class="p">:</span><span class="kt">String</span><span class="p">?</span>

    <span class="kd">func</span> <span class="nf">new</span><span class="p">(</span><span class="n">with</span> <span class="nv">careKitEntity</span><span class="p">:</span> <span class="kt">OCKEntity</span><span class="p">)</span><span class="o">-&gt;</span><span class="kt">PCKSynchronizable</span><span class="p">?</span> <span class="p">{</span>

        <span class="k">switch</span> <span class="n">careKitEntity</span> <span class="p">{</span>
        <span class="k">case</span> <span class="o">.</span><span class="nf">patient</span><span class="p">(</span><span class="k">let</span> <span class="nv">entity</span><span class="p">):</span>
            <span class="k">return</span> <span class="kt">Doctor</span><span class="p">(</span><span class="nv">careKitEntity</span><span class="p">:</span> <span class="n">entity</span><span class="p">)</span>
        <span class="k">default</span><span class="p">:</span>
            <span class="nf">os_log</span><span class="p">(</span><span class="s">"new(with:) The wrong type (%{private}@) of entity was passed"</span><span class="p">,</span> <span class="nv">log</span><span class="p">:</span> <span class="o">.</span><span class="n">carePlan</span><span class="p">,</span> <span class="nv">type</span><span class="p">:</span> <span class="o">.</span><span class="n">error</span><span class="p">,</span> <span class="n">careKitEntity</span><span class="o">.</span><span class="n">entityType</span><span class="o">.</span><span class="n">debugDescription</span><span class="p">)</span>
            <span class="nf">completion</span><span class="p">(</span><span class="kc">nil</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="c1">//Add a convienience initializer to to ensure that that the doctor class is always created correctly</span>
    <span class="nf">init</span><span class="p">(</span><span class="nv">careKitEntity</span><span class="p">:</span> <span class="kt">OCKAnyPatient</span> <span class="p">{</span>
        <span class="k">self</span><span class="o">.</span><span class="nf">init</span><span class="p">()</span>
        <span class="k">self</span><span class="o">.</span><span class="nf">copyCareKit</span><span class="p">(</span><span class="n">careKitEntity</span><span class="p">)</span>
        <span class="k">self</span><span class="o">.</span><span class="n">userInfo</span> <span class="o">=</span> <span class="p">[</span><span class="nv">kPCKCustomClassKey</span><span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">className</span><span class="p">]</span>
    <span class="p">}</span>

    <span class="nf">copyCareKit</span><span class="p">(</span><span class="n">_</span> <span class="nv">patientAny</span><span class="p">:</span> <span class="kt">OCKAnyPatient</span><span class="p">)</span><span class="o">-&gt;</span><span class="kt">Patient</span><span class="p">?</span> <span class="p">{</span>

        <span class="k">guard</span> <span class="k">let</span> <span class="nv">doctor</span> <span class="o">=</span> <span class="n">patientAny</span> <span class="k">as?</span> <span class="kt">OCKPatient</span> <span class="k">else</span><span class="p">{</span>
            <span class="k">return</span> <span class="kc">nil</span>
        <span class="p">}</span>

        <span class="k">super</span><span class="o">.</span><span class="nf">copyCareKit</span><span class="p">(</span><span class="n">doctor</span><span class="p">,</span> <span class="nv">clone</span><span class="p">:</span> <span class="n">clone</span><span class="p">)</span>
        <span class="k">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">cancerPatient</span><span class="o">.</span><span class="n">userInfo</span><span class="p">?[</span><span class="s">"CustomDoctorUserInfoTypeKey"</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">seld</span>
    <span class="p">}</span>

    <span class="kd">func</span> <span class="nf">convertToCareKit</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">OCKPatient</span><span class="p">?</span> <span class="p">{</span>
        <span class="k">guard</span> <span class="k">var</span> <span class="nv">partiallyConvertedDoctor</span> <span class="o">=</span> <span class="k">super</span><span class="o">.</span><span class="nf">convertToCareKit</span><span class="p">()</span> <span class="k">else</span><span class="p">{</span><span class="k">return</span> <span class="kc">nil</span><span class="p">}</span>

        <span class="k">var</span> <span class="nv">userInfo</span><span class="p">:</span> <span class="p">[</span><span class="kt">String</span><span class="p">:</span><span class="kt">String</span><span class="p">]</span><span class="o">!</span>
        <span class="k">if</span> <span class="n">partiallyConvertedDoctor</span><span class="o">.</span><span class="n">userInfo</span> <span class="o">==</span> <span class="kc">nil</span><span class="p">{</span>
            <span class="n">userInfo</span> <span class="o">=</span> <span class="p">[</span><span class="kt">String</span><span class="p">:</span><span class="kt">String</span><span class="p">]()</span>
        <span class="p">}</span><span class="k">else</span><span class="p">{</span>
            <span class="n">userInfo</span> <span class="o">=</span> <span class="n">partiallyConvertedDoctor</span><span class="o">.</span><span class="n">userInfo</span><span class="o">!</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="k">let</span> <span class="nv">type</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="n">type</span><span class="p">{</span>
            <span class="n">userInfo</span><span class="p">[</span><span class="s">"CustomDoctorUserInfoTypeKey"</span><span class="p">]</span> <span class="o">=</span> <span class="n">type</span>
        <span class="p">}</span>

        <span class="n">partiallyConvertedDoctor</span><span class="p">?</span><span class="o">.</span><span class="n">userInfo</span> <span class="o">=</span> <span class="n">userInfo</span>
        <span class="k">return</span> <span class="n">partiallyConvertedPatient</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<p><strong><em>You should never save changes to ParseCareKit classes directly to Parse as it may cause your data to get out-of-sync.</em></strong> Instead, user the <code>convertToCareKit</code> methods from each class and use the <code>add</code> or <code>update</code> methods from the CareStore. For example, the process below is recommended when creating new items to sync between CareKit and ParseCareKit</p>
<pre class="highlight swift"><code><span class="c1">//Create doctor using CareKit</span>
<span class="k">let</span> <span class="nv">newCareKitDoctor</span> <span class="o">=</span> <span class="kt">OCKPatient</span><span class="p">(</span><span class="nv">id</span><span class="p">:</span> <span class="s">"drJohnson"</span><span class="p">,</span> <span class="nv">givenName</span><span class="p">:</span> <span class="s">"Jane"</span><span class="p">,</span> <span class="nv">familyName</span><span class="p">:</span> <span class="s">"Johnson"</span><span class="p">)</span>

<span class="c1">//Initialize new Parse doctor with the CareKit one</span>
<span class="n">_</span> <span class="o">=</span> <span class="kt">Doctor</span><span class="p">(</span><span class="nv">careKitEntity</span><span class="p">:</span> <span class="n">newCareKitDoctor</span><span class="p">){</span>
   <span class="n">doctor</span> <span class="k">in</span>

   <span class="c1">//Make sure the Doctor was created as Parse doctor</span>
   <span class="k">guard</span> <span class="k">let</span> <span class="nv">newParseDoctor</span> <span class="o">=</span> <span class="n">doctor</span> <span class="k">as?</span> <span class="kt">Doctor</span> <span class="k">else</span><span class="p">{</span>
       <span class="k">return</span>
   <span class="p">}</span>

   <span class="c1">//Make any edits you need to the new doctor</span>
   <span class="n">newParseDoctor</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="s">"Cancer"</span> <span class="c1">//This was a custom value added in the Doctor class </span>
   <span class="n">newParseDoctor</span><span class="o">.</span><span class="n">sex</span> <span class="o">=</span> <span class="s">"Female"</span> <span class="c1">//This default from OCKPatient, Doctor has all defaults of it's CareKit counterpart</span>


   <span class="k">guard</span> <span class="k">let</span> <span class="nv">updatedCareKitDoctor</span> <span class="o">=</span> <span class="n">newParseDoctor</span><span class="o">.</span><span class="nf">convertToCareKit</span><span class="p">()</span> <span class="k">else</span> <span class="p">{</span>
       <span class="nf">completion</span><span class="p">(</span><span class="kc">nil</span><span class="p">,</span><span class="kc">nil</span><span class="p">)</span>
       <span class="k">return</span>
   <span class="p">}</span>

   <span class="n">store</span><span class="o">.</span><span class="nf">addPatient</span><span class="p">(</span><span class="n">updatedCareKitDoctor</span><span class="p">,</span> <span class="nv">callbackQueue</span><span class="p">:</span> <span class="o">.</span><span class="n">main</span><span class="p">){</span>
       <span class="n">result</span> <span class="k">in</span>

       <span class="k">switch</span> <span class="n">result</span><span class="p">{</span>

       <span class="k">case</span> <span class="o">.</span><span class="nf">success</span><span class="p">(</span><span class="k">let</span> <span class="nv">doctor</span><span class="p">):</span>
           <span class="nf">print</span><span class="p">(</span><span class="s">"Successfully add the doctor to the CareStore </span><span class="se">\(</span><span class="n">updatedCareKitDoctor</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
           <span class="nf">print</span><span class="p">(</span><span class="s">"CareKit and ParseCareKit will automatically handle syncing this data to the Parse Server"</span><span class="p">)</span>
       <span class="k">case</span> <span class="o">.</span><span class="nf">failure</span><span class="p">(</span><span class="k">let</span> <span class="nv">error</span><span class="p">):</span>
           <span class="nf">print</span><span class="p">(</span><span class="s">"Error, couldn't save doctor. </span><span class="se">\(</span><span class="n">error</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
       <span class="p">}</span>
   <span class="p">}</span>
<span class="p">}</span>

</code></pre>
<h3 id='querying-parse-like-ockquery-in-carekit' class='heading'>Querying Parse Like OCKQuery in CareKit</h3>

<p>There are some of helper methods provided in ParseCareKit to query parse in a similar way you would query in CareKit. This is important because <code><a href="Structs/PCKPatient.html">PCKPatient</a></code>, <code><a href="Structs/PCKCarePlan.html">PCKCarePlan</a></code>, <code><a href="Structs/PCKContact.html">PCKContact</a></code>, and <code><a href="Structs/PCKTask.html">PCKTask</a></code> are versioned entities and <code><a href="Structs/PCKOutcome.html">PCKOutcome</a></code>&rsquo;s are tombstoned. Querying each of the aforementioned classes with a reugular query will return all versions for &ldquo;versioned&rdquo; entities or tombstoned and not tombstoned <code><a href="Structs/PCKOutcome.html">PCKOutcome</a></code>s. A description of how versioning works in CareKit can be found <a href="https://github.com/carekit-apple/CareKit#carekitstore-">here</a>.</p>
<pre class="highlight swift"><code><span class="c1">//To query the most recent version</span>
<span class="k">let</span> <span class="nv">query</span> <span class="o">=</span> <span class="kt">Patient</span><span class="o">.</span><span class="nf">query</span><span class="p">(</span><span class="nv">for</span><span class="p">:</span> <span class="kt">Date</span><span class="p">())</span>

<span class="n">query</span><span class="o">.</span><span class="nf">find</span><span class="p">(</span><span class="nv">callbackQueue</span><span class="p">:</span> <span class="o">.</span><span class="n">main</span><span class="p">){</span> <span class="n">results</span> <span class="k">in</span>

    <span class="k">switch</span> <span class="n">results</span> <span class="p">{</span>

    <span class="k">case</span> <span class="o">.</span><span class="nf">success</span><span class="p">(</span><span class="k">let</span> <span class="nv">patients</span><span class="p">):</span>
        <span class="nf">print</span><span class="p">(</span><span class="n">patients</span><span class="p">)</span>
    <span class="k">case</span> <span class="o">.</span><span class="nf">failure</span><span class="p">(</span><span class="k">let</span> <span class="nv">error</span><span class="p">):</span>
        <span class="nf">print</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<p>For <code><a href="Structs/PCKOutcome.html">PCKOutcome</a></code>:</p>
<pre class="highlight swift"><code><span class="c1">//To query all current outcomes</span>
<span class="k">let</span> <span class="nv">query</span> <span class="o">=</span> <span class="kt">Outcome</span><span class="o">.</span><span class="nf">queryNotDeleted</span><span class="p">()</span>
<span class="n">query</span><span class="o">.</span><span class="nf">find</span><span class="p">(</span><span class="nv">callbackQueue</span><span class="p">:</span> <span class="o">.</span><span class="n">main</span><span class="p">){</span> <span class="n">results</span> <span class="k">in</span>

    <span class="k">switch</span> <span class="n">results</span> <span class="p">{</span>

    <span class="k">case</span> <span class="o">.</span><span class="nf">success</span><span class="p">(</span><span class="k">let</span> <span class="nv">outcomes</span><span class="p">):</span>
        <span class="nf">print</span><span class="p">(</span><span class="n">outcomes</span><span class="p">)</span>
    <span class="k">case</span> <span class="o">.</span><span class="nf">failure</span><span class="p">(</span><span class="k">let</span> <span class="nv">error</span><span class="p">):</span>
        <span class="nf">print</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

</code></pre>
<h3 id='custom-ockstores' class='heading'>Custom OCKStores</h3>

<p>If you have a custom store, and have created your own entities, you simply need to conform to  <code><a href="Protocols/PCKVersionable.html">PCKVersionable</a></code> (OCKPatient, OCKCarePlan, OCKTask, OCKContact, OCKOutcome) protocols. In addition you will need to conform to <code><a href="Protocols/PCKSynchronizable.html">PCKSynchronizable</a></code>. You can look through ParseCareKit entities such as <code>PCKCarePlan</code>(<code>PCKVersionable</code>) as a reference for building your own. </p>

          </div>
        </section>


      </article>
    </div>
    <section class="footer">
      <p>&copy; 2022 <a class="link" href="https://www.cs.uky.edu/~baker" target="_blank" rel="external noopener">Corey E. Baker</a>. All rights reserved. (Last updated: 2022-01-20)</p>
      <p>Generated by <a class="link" href="https://github.com/realm/jazzy" target="_blank" rel="external noopener">jazzy ♪♫ v0.14.1</a>, a <a class="link" href="https://realm.io" target="_blank" rel="external noopener">Realm</a> project.</p>
    </section>
  </body>
</html>
